!function(){"use strict";const l_getDom=function(target){return function(target){if(target&&target.nodeName)return target;if(!("string"==typeof target||target instanceof String))throw new Error("DOM not found");{let dom=document.getElementById(target);if(dom)return dom}}(target)};var ws=new WebSocket("ws://"+location.hostname+":80");function eventConfig(e){e.target.closest("a");let d_button=e.target.closest("button"),d_form=(e.target.closest("div"),e.target.closest("form"));if("submit"==e.type&&d_form&&"form_config"==d_form.id){e.preventDefault();let data={cmd:"save_settings",melody_status:l_getDom("melody_status").value,spray_time:l_getDom("spray_time_ms").value,wifi_ssid:l_getDom("wifi_ssid").value,wifi_pass:l_getDom("wifi_pass").value};console.log("Saving settings..."),ws.send(JSON.stringify(data))}"click"==e.type&&d_button&&"reset_bag"==d_button.id&&(console.log("Resetting bag..."),ws.send(JSON.stringify({cmd:"reset_bag",volume_ml:500})),l_getDom("output").value="Reset Bag")}ws.onmessage=function(evt){l_getDom("output").value=evt.data},window.addEventListener("click",eventConfig),window.addEventListener("submit",eventConfig),window.onload=function(){!function(){let mlSprayed=parseInt(params.ml_sprayed,10),bagLevel=100*Math.round((500-mlSprayed)/500),bagPctMsg=bagLevel+"% remaining";l_getDom("bag_pct_msg").innerHTML=bagPctMsg,l_getDom("bag_level").value=bagLevel,l_getDom("wifi_ssid").value=params.ssid,l_getDom("wifi_pass").value=params.pass,l_getDom("wifi_status").innerHTML="1"==params.wifi_status?"Connected to internet":"Not connected to internet"}()}}();